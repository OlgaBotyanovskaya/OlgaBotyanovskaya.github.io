(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1141:function(e,t,n){"use strict";n.r(t),n.d(t,"PopupWrap",(function(){return E}));var r,o,c,l,d=n(15),m=(n(35),n(19),n(24),n(63),n(136),n(41),n(38),n(12)),v=n(13),f=n.n(v),h=n(3),k=n.n(h),V=n(8),w=n(138),S=n(6),O=n(16),P=n(7),F=n(1),j=(r={},Object(P.a)(r,F.wd.Subscribe,[F.vd.SubscribeV1,F.vd.SubscribeV2,F.vd.SubscribeV3,F.vd.SubscribeV4,F.vd.SubscribeV5,F.vd.SubscribeV6,F.vd.SubscribeV7,F.vd.SubscribeV8,F.vd.SubscribeV9,F.vd.SubscribeV10,F.vd.SubscribeV11]),Object(P.a)(r,F.wd.ContactUs,[F.vd.ContactUsV1,F.vd.ContactUsV2,F.vd.ContactUsV3,F.vd.ContactUsV4,F.vd.ContactUsV5]),Object(P.a)(r,F.wd.Feedback,[F.vd.FeedbackV1,F.vd.FeedbackV2]),Object(P.a)(r,F.wd.Promotion,[F.vd.PromotionsV1,F.vd.PromotionsV2,F.vd.PromotionsV3,F.vd.PromotionsV4,F.vd.PromotionsV5,F.vd.PromotionsV6]),Object(P.a)(r,F.wd.AgeVerification,[F.vd.AgeVerificationV1,F.vd.AgeVerificationV2,F.vd.AgeVerificationV3,F.vd.AgeVerificationV4]),Object(P.a)(r,F.wd.SocialBar,[F.vd.SocialBarV1,F.vd.SocialBarV2]),[F.vd.ContactUsV4,F.vd.ContactUsV5,F.vd.AgeVerificationV1,F.vd.AgeVerificationV2,F.vd.PromotionsV1,F.vd.PromotionsV2,F.vd.PromotionsV3,F.vd.FeedbackV1,F.vd.SubscribeV2,F.vd.SubscribeV3,F.vd.SubscribeV10]),x=(o={},Object(P.a)(o,F.Tb.Title,new F.Ob({isEnabled:!0})),Object(P.a)(o,F.Tb.Description,new F.Ob({isEnabled:!0})),o),C=(c={},Object(P.a)(c,F.Sb.ConfirmationTitle,new F.Ob({isEnabled:!0})),Object(P.a)(c,F.Sb.ConfirmationDescription,new F.Ob({isEnabled:!0})),c),y=n(10),R=(l={},Object(P.a)(l,F.vd.SubscribeV1,{component:function(){return n.e(174).then(n.bind(null,1081))}}),Object(P.a)(l,F.vd.SubscribeV2,{component:function(){return n.e(174).then(n.bind(null,1082))}}),Object(P.a)(l,F.vd.SubscribeV3,{component:function(){return n.e(174).then(n.bind(null,1083))}}),Object(P.a)(l,F.vd.SubscribeV4,{component:function(){return n.e(174).then(n.bind(null,1084))}}),Object(P.a)(l,F.vd.SubscribeV5,{component:function(){return n.e(174).then(n.bind(null,1085))}}),Object(P.a)(l,F.vd.SubscribeV6,{component:function(){return n.e(174).then(n.bind(null,1086))}}),Object(P.a)(l,F.vd.SubscribeV7,{component:function(){return n.e(174).then(n.bind(null,1087))}}),Object(P.a)(l,F.vd.SubscribeV8,{component:function(){return n.e(174).then(n.bind(null,1088))}}),Object(P.a)(l,F.vd.SubscribeV9,{component:function(){return n.e(174).then(n.bind(null,1089))}}),Object(P.a)(l,F.vd.SubscribeV10,{component:function(){return n.e(174).then(n.bind(null,1090))}}),Object(P.a)(l,F.vd.SubscribeV11,{component:function(){return n.e(174).then(n.bind(null,1091))}}),Object(P.a)(l,F.vd.ContactUsV1,{component:function(){return n.e(170).then(n.bind(null,1092))}}),Object(P.a)(l,F.vd.ContactUsV2,{component:function(){return n.e(170).then(n.bind(null,1093))}}),Object(P.a)(l,F.vd.ContactUsV3,{component:function(){return n.e(170).then(n.bind(null,1094))}}),Object(P.a)(l,F.vd.ContactUsV4,{component:function(){return n.e(170).then(n.bind(null,1095))}}),Object(P.a)(l,F.vd.ContactUsV5,{component:function(){return n.e(170).then(n.bind(null,1096))}}),Object(P.a)(l,F.vd.SocialBarV1,{component:function(){return n.e(173).then(n.bind(null,1097))}}),Object(P.a)(l,F.vd.SocialBarV2,{component:function(){return n.e(173).then(n.bind(null,1098))}}),Object(P.a)(l,F.vd.AgeVerificationV1,{component:function(){return n.e(169).then(n.bind(null,1099))}}),Object(P.a)(l,F.vd.AgeVerificationV2,{component:function(){return n.e(169).then(n.bind(null,1100))}}),Object(P.a)(l,F.vd.AgeVerificationV3,{component:function(){return n.e(169).then(n.bind(null,1101))}}),Object(P.a)(l,F.vd.AgeVerificationV4,{component:function(){return n.e(169).then(n.bind(null,1102))}}),Object(P.a)(l,F.vd.PromotionsV1,{component:function(){return n.e(172).then(n.bind(null,1103))}}),Object(P.a)(l,F.vd.PromotionsV2,{component:function(){return n.e(172).then(n.bind(null,1104))}}),Object(P.a)(l,F.vd.PromotionsV3,{component:function(){return n.e(172).then(n.bind(null,1105))}}),Object(P.a)(l,F.vd.PromotionsV4,{component:function(){return n.e(172).then(n.bind(null,1106))}}),Object(P.a)(l,F.vd.PromotionsV5,{component:function(){return n.e(172).then(n.bind(null,1107))}}),Object(P.a)(l,F.vd.PromotionsV6,{component:function(){return n.e(172).then(n.bind(null,1108))}}),Object(P.a)(l,F.vd.FeedbackV1,{component:function(){return n.e(171).then(n.bind(null,1109))}}),Object(P.a)(l,F.vd.FeedbackV2,{component:function(){return n.e(171).then(n.bind(null,1110))}}),l),_=[Object(S.hb)("id"),Object(S.hb)("rules")].join(","),E=m.componentFactory.create({name:"PopupWrap",props:{site:k.a.ofType().required,isEnabledLiveEditor:k.a.ofType().default(!1)},data:function(){return{timer:null,rulesTimer:null,routeWatcher:null,isVisibleModal:!1,isConfirmationVisiable:!1,isLoading:!1,subscribeForm:new F.yb,subscribeForms:[],formData:new F.a({emailAddress:null}),validationRules:{emailAddress:new w.c({name:"Email",type:V.G.Email})},errors:[],exitIntent:!1,scrollTrigger:!1,pagesRules:!1,frequencyRules:!1,targetingRules:!1,visibleForms:[],isAllPagesPopup:!1,responseStatus:null}},fetch:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.mainSubsribeFormId){t.next=6;break}return t.next=4,e.fetchSubscribeForm(e.mainSubsribeFormId);case 4:t.next=8;break;case 6:return t.next=8,e.fetchSubscribesForm(_);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),null===y.a||void 0===y.a||y.a.errorLog({error_name:t.t0.name,message:t.t0.message,stack:t.t0.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},fetchOnServer:!1,mounted:function(){var e,t,n=this;this.$root.$on("closePopup",(function(){return n.onClose(!1)})),this.routeWatcher=this.$watch("$route",(function(e,t){if(e.path!=t.path){var r;if(n.isVisibleModal)n.onClose(!1),n.$store.dispatch("setCurrentPopup",null),n.visibleForms.push(null===(r=n.subscribeForm)||void 0===r?void 0:r.id);n.rulesTimer=setTimeout((function(){n.isAllPagesPopup=!1,n.subscribeForms.map(function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.checkPagesRules(t.rules,t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),1e3)}})),window&&window.addEventListener("beforeunload",this.onSetNotUniqueUser),null===(e=document)||void 0===e||e.addEventListener("mouseout",this.onMouseoutHandler),null===(t=document)||void 0===t||t.addEventListener("scroll",this.onScrollHandler)},beforeDestroy:function(){var e,t,n;this.routeWatcher(),this.onSetNotUniqueUser(),this.$root.$off("closePopup"),clearTimeout(this.timer),clearTimeout(this.rulesTimer),null===(e=window)||void 0===e||e.removeEventListener("onbeforeunload",this.onSetNotUniqueUser),null===(t=document)||void 0===t||t.removeEventListener("mouseout",this.onMouseoutHandler),null===(n=document)||void 0===n||n.removeEventListener("scroll",this.onScrollHandler)},computed:{siteId:function(){var e,t;return(null===(e=this.$site)||void 0===e?void 0:e.id)||this.$cookies.get("siteId")||(null===(t=this.site)||void 0===t?void 0:t.id)||this.$store.getters.getSiteId},subscribeFormId:function(){return this.$store.getters.getCurrentPopup},currentSite:function(){return this.$store.getters.getSite(this.$cookies,this.$site||this.site)},mainSubsribeFormId:function(){return this.currentSite.subscribeFormId},error:function(){var e,t=null===(e=this.errors)||void 0===e?void 0:e.find((function(e){return"emailAddress"==e.fieldName}));return t?t.message:null},rules:function(){var e;return Object(S.U)(null===(e=this.subscribeForm)||void 0===e?void 0:e.rules)?new F.ld({triggers:new F.qd({type:F.td.ExitIntent}),displayOnPages:new F.md({type:F.id.AllPages}),frequency:new F.nd({type:F.jd.EachPageVisit}),targeting:new F.pd({type:F.rd.AllVisitors})}):this.subscribeForm.rules},animationEnterClassNames:function(){var e=["animate__animated"];if(this.subscribeForm.transition){var t=O.q[this.subscribeForm.transition]||"animate__bounceIn";e.push(t)}else e.push("animate__bounceIn");return e.join(" ")},animationLeaveClassNames:function(){var e,t=["animate__animated"];if(null!==(e=this.subscribeForm)&&void 0!==e&&e.transition){var n,r=O.r[null===(n=this.subscribeForm)||void 0===n?void 0:n.transition]||"animate__bounceOut";t.push(r)}else t.push("animate__bounceOut");return t.join(" ")},popupTypeClassName:function(){switch(this.subscribeForm.type){case F.ud.Popup:return"kmb-site-pop-up-widget-form-type-popup";case F.ud.FloatingBarVertical:return"kmb-site-pop-up-widget-form-type-floating-bar";case F.ud.FloatingBarHorizontal:return"kmb-site-pop-up-widget-form-type-popup kmb-site-pop-up-widget-form-type-floating-bar-horizontal";default:return"kmb-site-pop-up-widget-form-type-popup"}},popupContainerClass:function(){var e=this;return j.find((function(t){return t==e.subscribeForm.variationType}))?"kmb-site-pop-up-full-widget-container":"kmb-site-pop-up-widget-container"},popupPositionClassName:function(){switch(this.subscribeForm.position){case F.kd.Left:return"kmb-site-pop-up-widget-form-left-bottom";case F.kd.Right:return"kmb-site-pop-up-widget-form-right-bottom";case F.kd.Top:return"kmb-site-pop-up-widget-form-top";case F.kd.Bottom:return"kmb-site-pop-up-widget-form-bottom";case F.kd.Center:default:return"kmb-site-pop-up-widget-form-middle"}},isHiddenCloseModalBtn:function(){var e,t,n,r,o;return(null===(e=this.subscribeForm)||void 0===e||null===(t=e.ageVerification)||void 0===t||null===(n=t.elementsShowSettings)||void 0===n||null===(r=n[F.Rb.CloseButton])||void 0===r?void 0:r.isEnabled)||(null===(o=this.subscribeForm)||void 0===o?void 0:o.widgetType)!=F.wd.AgeVerification},alreadyOpenedPopup:function(){var e=this;return-1!==this.visibleForms.findIndex((function(t){var n;return t==(null===(n=e.subscribeForm)||void 0===n?void 0:n.id)}))}},watch:{subscribeFormId:function(e,t){var n=this;return Object(d.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e==t||!e){r.next=3;break}return r.next=3,n.fetchSubscribeForm(n.subscribeFormId);case 3:case"end":return r.stop()}}),r)})))()}},methods:{onClose:function(e){var t=this;this.isVisibleModal=e,this.isConfirmationVisiable=e,setTimeout((function(){return t.$store.dispatch("setCurrentPopup",null)}),300)},fetchSubscribesForm:function(e){var t=this;return Object(d.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$api.get(new F.xb({siteId:t.siteId,fields:e}));case 3:r=n.sent,Object(S.S)(r.results)||(t.subscribeForms=r.results,t.isAllPagesPopup=!1,t.subscribeForms.forEach(function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkPagesRules(n.rules,n.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),null===y.a||void 0===y.a||y.a.errorLog({error_name:n.t0.name,message:n.t0.message,stack:n.t0.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"});case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},fetchSubscribeForm:function(e){var t=this;return Object(d.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,-1===t.visibleForms.findIndex((function(t){return t==e}))){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,t.$api.get(new F.xb({siteId:t.siteId,id:e}));case 5:r=n.sent,Object(S.S)(r.results)||(t.subscribeForm=r.results[0],t.initElementsShowSettings(),t.setRules()),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),null===y.a||void 0===y.a||y.a.errorLog({error_name:n.t0.name,message:n.t0.message,stack:n.t0.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"});case 12:case"end":return n.stop()}}),n,null,[[0,9]])})))()},initElementsShowSettings:function(){try{var e,t,n,r,o,c;!Object(S.U)(null===(e=this.subscribeForm)||void 0===e?void 0:e.subscribe)&&Object(S.U)(null===(t=this.subscribeForm)||void 0===t||null===(n=t.subscribe)||void 0===n?void 0:n.elementsShowSettings)&&(this.subscribeForm.subscribe.elementsShowSettings=x),!Object(S.U)(null===(r=this.subscribeForm)||void 0===r?void 0:r.subscribe)&&Object(S.U)(null===(o=this.subscribeForm)||void 0===o||null===(c=o.subscribe)||void 0===c?void 0:c.confirmationElementsShowSettings)&&(this.subscribeForm.subscribe.confirmationElementsShowSettings=C)}catch(e){null===y.a||void 0===y.a||y.a.errorLog({error_name:e.name,message:e.message,stack:e.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"})}},onScrollHandler:function(){try{if(this.scrollTrigger&&!this.alreadyOpenedPopup){var body=document.body;if(body){var e,t,n,r=body.parentNode;if((body.scrollTop||r.scrollTop)/(r.scrollHeight-r.clientHeight)*100>(null===(e=this.rules)||void 0===e||null===(t=e.triggers)||void 0===t?void 0:t.scrollPercent))if(this.pagesRules&&this.frequencyRules&&this.targetingRules)this.isVisibleModal=!0,this.visibleForms.push(null===(n=this.subscribeForm)||void 0===n?void 0:n.id)}}}catch(e){null===y.a||void 0===y.a||y.a.errorLog({error_name:e.name,message:e.message,stack:e.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"})}},onMouseoutHandler:function(e){try{var t;if((null==e||!e.relatedTarget)&&this.exitIntent&&!this.alreadyOpenedPopup)if(this.pagesRules&&this.frequencyRules&&this.targetingRules)this.isVisibleModal=!0,this.visibleForms.push(null===(t=this.subscribeForm)||void 0===t?void 0:t.id),this.exitIntent=!1}catch(e){null===y.a||void 0===y.a||y.a.errorLog({error_name:e.name,message:e.message,stack:e.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"})}},onSetNotUniqueUser:function(){this.$cookies.set("notUniqueUser",!0)},setRules:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.rules.mainTrigger!=F.od.ButtonClicking){t.next=4;break}return e.isVisibleModal=!0,t.abrupt("return");case 4:return t.next=6,e.checkPagesRules(e.rules);case 6:e.pagesRules=t.sent,e.frequencyRules=e.checkFrequencyRules(),e.targetingRules=e.checkTargetingRules(),n=e.rules||{},r=n.triggers,Object(S.U)(r)||(o=r.type,c=r.timer,o==F.td.Timer&&c&&(e.timer=setTimeout((function(){var t;e.pagesRules&&e.frequencyRules&&e.targetingRules&&(e.isVisibleModal=!0,e.visibleForms.push(null===(t=e.subscribeForm)||void 0===t?void 0:t.id))}),1e3*c)),o==F.td.ExitIntent&&e.pagesRules&&e.frequencyRules&&e.targetingRules&&(e.exitIntent=!0),o==F.td.ScrollPercentOfPage&&e.pagesRules&&e.frequencyRules&&e.targetingRules&&(e.scrollTrigger=!0)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),null===y.a||void 0===y.a||y.a.errorLog({error_name:t.t0.name,message:t.t0.message,stack:t.t0.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"});case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},checkPagesRules:function(e,t){var n=this;return Object(d.a)(regeneratorRuntime.mark((function r(){var o,c,l,d,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,o=(null==e?void 0:e.displayOnPages)||{},c=o.type,l=o.pageIds,(null==e?void 0:e.mainTrigger)!=F.od.ButtonClicking){r.next=6;break}return r.abrupt("return",!1);case 6:if(c!=F.id.AllPages){r.next=14;break}if(t!=n.mainSubsribeFormId||n.isAllPagesPopup){r.next=11;break}return n.isAllPagesPopup=!0,r.next=11,n.fetchSubscribeForm(t);case 11:return r.abrupt("return",!0);case 14:if(c!=F.id.SpecificPages||Object(S.S)(l)||n.isAllPagesPopup){r.next=23;break}if(d=n.$store.getters.getPage,!(m=l.includes(null==d?void 0:d.id))||!t){r.next=20;break}return r.next=20,n.fetchSubscribeForm(t);case 20:return r.abrupt("return",m);case 23:return r.abrupt("return",!1);case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(0),null===y.a||void 0===y.a||y.a.errorLog({error_name:r.t0.name,message:r.t0.message,stack:r.t0.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"});case 29:case"end":return r.stop()}}),r,null,[[0,26]])})))()},checkFrequencyRules:function(){try{var e=this.rules.frequency||{},t=e.type,n=e.timePerSession;if(t==F.jd.EachPageVisit)return!0;if(0!=n)return this.updateFrequencyCookie()}catch(e){null===y.a||void 0===y.a||y.a.errorLog({error_name:e.name,message:e.message,stack:e.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"})}},checkTargetingRules:function(){try{var e=(this.rules.targeting||{}).type;if(e==F.rd.AllVisitors)return!0;if(e==F.rd.ReturningVisitors){var t=this.$cookies.get("notUniqueUser");if(null!=t&&1==t)return!0}else if(e==F.rd.NewVisitors){var n=this.$cookies.get("notUniqueUser");return null==n||0==n}}catch(e){null===y.a||void 0===y.a||y.a.errorLog({error_name:e.name,message:e.message,stack:e.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"})}},updateFrequencyCookie:function(){try{var e=null,t=this.$cookies.get("timesPerSession");if(null!=t){if(0==t)e=!1;else{var n=t-1;this.$cookies.remove("timesPerSession"),this.$cookies.set("timesPerSession",n),e=!0}return e}return this.$cookies.set("timesPerSession",this.rules.frequency.timePerSession),!0}catch(e){null===y.a||void 0===y.a||y.a.errorLog({error_name:e.name,message:e.message,stack:e.stack,source_dir:"components/Builder/CommonElements/PopupWrap/",source_file:"index.tsx"})}}},render:function(e){var t,n,r=this;if(!Object(S.U)(this.subscribeForm))return e("div",{class:f()("kmb-site-popup-wrap",{"kmb-site-popup-wrap-opened":this.isVisibleModal})},[e("transition",{attrs:{name:"kmb-pop-up-widget-fade","enter-active-class":this.animationEnterClassNames,"leave-active-class":this.animationLeaveClassNames}},[this.isVisibleModal&&e("div",{class:f()("kmb-site-pop-up-widget kmb-site-pop-up-modal",this.popupTypeClassName,this.popupPositionClassName,this.popupContainerClass,{"kmb-site-pop-up-widget-confirmation":this.isConfirmationVisiable})},[e("div",{class:"kmb-site-pop-up-modal-dialog w-full"},[e("div",{class:"kmb-site-modal-content"},[this.isHiddenCloseModalBtn&&e("div",{class:"kmb-site-modal-header kmb-site-pop-up-modal-header"},[e("button",{class:"kmb-site-close-modal-btn",attrs:{"aria-label":"close"},on:{click:function(){return r.onClose(!1)}}},[e("i",{class:"kmb-site-icon-close"})])]),e("div",{class:"kmb-site-modal-body"},[e("div",{class:"kmb-page-widget widget-toolbar-visible"},[e(null===(t=R[this.subscribeForm.variationType])||void 0===t?void 0:t.component,{props:{settings:this.subscribeForm,widget:this.subscribeForm,isEnabledLiveEditor:this.isEnabledLiveEditor},style:{backgroundColor:null===(n=this.subscribeForm)||void 0===n?void 0:n.backgroundColor}})])])])])])])])}});t.default=E}}]);